# ========== 现有 SurrealDB 配置 ==========
total_sync = false
incr_sync = false
enable_log = false
sync_graph_db = false
sync_versioned = false
sync_tidb = false
sync_live = true
replace_dbs = false
sync_chunk_size = 10000

project_path = "D:/AVEVA/Projects/E3D2.1"
included_projects = ["AvevaMarineSample", "AvevaCatalogue", "SCB", "ZDJ"]
mdb_name = "ALL"
project_name = "AvevaMarineSample"
project_code = 1516
surreal_ns = 1516
module = "DESI"

gen_model = true
gen_mesh = true
replace_mesh = true
save_db = true
apply_boolean_operation = true
mesh_tol_ratio = 3.0
gen_spatial_tree = true
load_spatial_tree = false
save_spatial_tree_to_db = false
gen_model_batch_size = 16

# 版本数据库服务配置
v_ip = "127.0.0.1"
v_port = "8009"
v_user = "root"
v_password = "root"
pe_chunk = 500
att_chunk = 200

# MQTT 事件配置
mqtt_host = "192.168.31.60"
mqtt_port = 8883
location = "SJZ1"

# 服务器启动配置
server_release_ip = "127.0.0.1:9099"
remote_file_server_hosts = []
file_server_host = "http://192.168.31.38:8100/asset/archives"

# ========== Kuzu 数据库配置（新增） ==========
[kuzu]
# 是否启用 Kuzu 图数据库
enable = true

# 数据库文件路径（嵌入式数据库，本地文件）
# 建议使用绝对路径或相对于项目根目录的路径
database_path = "./data/kuzu_db"

# 缓冲池大小（字节）
# 默认 4GB，根据可用内存调整
buffer_pool_size = 4294967296

# 最大线程数
# 不设置则使用 CPU 核心数
# max_num_threads = 8

# ========== 混合模式配置 ==========
[kuzu.hybrid]
# 混合模式选项：
#   - "surreal_primary"           SurrealDB 为主，Kuzu 为辅
#   - "kuzu_primary"              Kuzu 为主，SurrealDB 为辅
#   - "dual_surreal_preferred"    双写双读，优先 SurrealDB
#   - "dual_kuzu_preferred"       双写双读，优先 Kuzu（推荐图查询场景）
#   - "write_surreal_read_kuzu"   写入 SurrealDB，读取 Kuzu
mode = "dual_kuzu_preferred"

# 查询超时时间（毫秒）
query_timeout_ms = 5000

# 是否在主数据库失败时回退到备用数据库
fallback_on_error = true

# ========== 数据同步配置 ==========
[kuzu.sync]
# 是否启用自动同步
enabled = true

# 同步方向：
#   - "surreal_to_kuzu"   从 SurrealDB 同步到 Kuzu（推荐）
#   - "bidirectional"     双向同步（慎用）
direction = "surreal_to_kuzu"

# 同步间隔（秒）
# 建议根据数据变更频率调整，默认 5 分钟
interval_secs = 300

# 批量同步大小
batch_size = 1000

# 同步内容控制
sync_pe = true            # 是否同步 PE 数据
sync_attributes = true    # 是否同步属性数据
sync_relations = true     # 是否同步关系数据

# 冲突解决策略：
#   - "surreal_wins"  SurrealDB 数据优先（推荐）
#   - "kuzu_wins"     Kuzu 数据优先
#   - "latest_wins"   最新修改优先
conflict_resolution = "surreal_wins"