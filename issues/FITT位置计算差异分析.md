# FITT位置计算差异分析

## 问题描述

FITT类型局部空间变换中，方向计算已完全正确，但位置计算存在2050.610mm差异。

## 当前状态

- ✅ 方向计算：Y轴=E方向，Z轴=S方向，完全匹配验证集
- ❌ 位置计算：实际DVec3(0.0, 0.0, 8025.0) vs 期望DVec3(0.0, 1450.0, 6575.0)

## 测试案例

- RefNo: 25688/7960
- 父级: 25688/7958 (STWALL)
- 验证集期望: Position E 0mm N 1450mm U 6575mm

## 分析方向

### 1. 数据库属性查询

需要查询FITT元素的实际属性值：

- POS: 位置属性
- POSL: 位置线属性  
- ZDIS: Z轴距离
- 其他相关属性

### 2. 坐标框架分析

- 确认位置数据存储在哪个坐标框架中
- 分析是否需要额外的坐标变换步骤
- 检查PDMS原始实现中FITT位置处理逻辑

### 3. 变换逻辑验证

- 验证当前的逆变换方法是否正确
- 检查是否需要在FITT局部坐标系中重新计算位置偏移
- 分析8025mm值的来源（可能是sqrt(1450²+6575²)的某种变换）

## 下一步行动

1. 查询数据库中FITT元素的实际属性值
2. 对比新旧实现的差异
3. 参考IDA Pro分析结果确定正确的位置计算逻辑
4. 实现并验证修复方案

## 相关文件

- `src/transform/strategies/default.rs` - FITT实现逻辑
- `src/test/test-cases/spatial/spatial_local_cases.json` - 验证数据
- `examples/verify_fitt_ground_truth.rs` - 数据库查询工具
